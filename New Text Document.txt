# Define the path to the CSV file
$csvFilePath = "C:\path\to\your\file.csv"

# Read the CSV file
$csvData = Import-Csv $csvFilePath

# Iterate through each row in the CSV
foreach ($row in $csvData) {
    # Get the group name from the specified column in the CSV
    $groupName = $row."Group Name"

    # Check if the group exists in AD
    if (Get-ADGroup -Filter { Name -eq $groupName }) {
        # Get members of the group
        $members = Get-ADGroupMember -Identity $groupName | Select-Object -ExpandProperty SamAccountName -First 5

        # Update the result column with member names or "No member found"
        if ($members) {
            $row.Result = $members -join ', '

            # Extract employee numbers for each member
            $employeeNumbers = $members | ForEach-Object {
                $employeeNumber = Get-ADUser -Identity $_ -Properties EmployeeNumber | Select-Object -ExpandProperty EmployeeNumber
                $employeeNumber -or "N/A"
            }

            $row."Employee Numbers" = $employeeNumbers -join ', '
        } else {
            $row.Result = "No member found"
            $row."Employee Numbers" = "N/A"
        }
    } else {
        # Update the result column with "No group found"
        $row.Result = "No group found"
        $row."Employee Numbers" = "N/A"
    }
}

# Save the updated data back to the CSV file
$csvData | Export-Csv -Path $csvFilePath -NoTypeInformation
