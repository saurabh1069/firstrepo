# Load Outlook COM object
Add-Type -AssemblyName "Microsoft.Office.Interop.Outlook" | Out-Null

# Create Outlook Application object
$outlook = New-Object -ComObject Outlook.Application

# Access the Sent Items folder
$sentItemsFolder = $outlook.Session.GetDefaultFolder(5) # 5 corresponds to olFolderSentMail

# Count the number of subfolders in the Sent Items folder
$numberOfSubfolders = $sentItemsFolder.Folders.Count

# Display the result
Write-Host "Number of subfolders in Sent Items: $numberOfSubfolders"

# Release COM objects
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($sentItemsFolder) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($outlook) | Out-Null
Remove-Variable outlook
